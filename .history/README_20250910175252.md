# Excel 图片批量下载器

一个基于 Python 的桌面应用程序，可以从 Excel 表格中读取数据并批量下载图片。

## 功能特点

- 📊 **Excel 数据导入**：支持 `.xlsx` 和 `.xls` 格式
- 🖼️ **图片预览**：导入数据后可以预览表格内容
- 🏷️ **自定义命名**：可自定义下载图片的文件名格式
- 📥 **批量下载**：支持一键批量下载所有图片
- 💻 **跨平台**：支持 Windows 和 macOS 系统
- 🔄 **实时进度**：显示下载进度和状态

## Excel 表格格式要求

Excel 文件必须包含以下三列：

| 姓名 | 俱乐部名称 | 照片链接 |
|------|-----------|---------|
| 王晓燕 | 天天俱乐部 | https://example.com/photo1.jpg |
| 李明 | 阳光体育 | https://example.com/photo2.jpg |

## 使用方法

### 方法一：下载编译好的程序（推荐）

1. 前往 [Releases](../../releases) 页面
2. 下载适合您系统的版本：
   - Windows: `Excel图片下载器.exe`
   - macOS: `Excel图片下载器`
3. 双击运行程序

### 方法二：从源码运行

1. 克隆项目到本地：
   ```bash
   git clone <repository-url>
   cd tiyudowond
   ```

2. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

3. 运行程序：
   ```bash
   python main.py
   ```

## 详细使用步骤

1. **选择 Excel 文件**
   - 点击"浏览"按钮选择包含数据的 Excel 文件
   - 点击"导入数据"按钮加载数据

2. **预览数据**
   - 在表格中查看导入的姓名、俱乐部名称和照片链接
   - 确认数据正确性

3. **设置下载参数**
   - 选择图片保存的文件夹
   - 自定义文件命名格式（默认：`{club}_{name}.png`）
   - 可用变量：`{name}`（姓名）、`{club}`（俱乐部名称）

4. **开始下载**
   - 点击"开始批量下载"按钮
   - 观察进度条和状态信息
   - 下载完成后会显示成功和失败的数量

## 文件命名示例

默认命名格式 `{club}_{name}.png` 会生成如下文件名：
- `天天俱乐部_王晓燕.png`
- `阳光体育_李明.png`

您也可以自定义其他格式：
- `{name}_{club}.jpg` → `王晓燕_天天俱乐部.jpg`
- `{name}.png` → `王晓燕.png`
- `照片_{club}_{name}.jpeg` → `照片_天天俱乐部_王晓燕.jpeg`

## 系统要求

- **操作系统**：Windows 10+ 或 macOS 10.14+
- **网络连接**：需要互联网连接以下载图片
- **存储空间**：确保有足够空间存储下载的图片

## 开发相关

### 技术栈

- **Python 3.11+**
- **tkinter**：GUI 框架
- **pandas**：Excel 文件处理
- **requests**：图片下载
- **Pillow**：图片处理
- **PyInstaller**：打包工具

### 本地开发

1. 安装 Python 3.11+
2. 安装依赖：`pip install -r requirements.txt`
3. 运行：`python main.py`

### 打包编译

使用 PyInstaller 打包：

```bash
# Windows
pyinstaller --onefile --windowed --name="Excel图片下载器" main.py

# macOS
pyinstaller --onefile --windowed --name="Excel图片下载器" main.py
```

### 自动编译

项目配置了 GitHub Actions，当推送到主分支或创建标签时会自动编译：

1. **推送到 main/master 分支**：触发编译，生成 artifacts
2. **创建版本标签**：如 `v1.0.0`，会自动创建 Release 并上传编译好的程序

## 常见问题

**Q: 下载失败怎么办？**
A: 检查网络连接和图片链接是否有效，程序会显示具体的失败数量。

**Q: 支持哪些图片格式？**
A: 支持常见的网络图片格式（JPG、PNG、GIF 等），最终会根据您设置的命名格式保存。

**Q: Excel 文件格式有什么要求？**
A: 必须包含"姓名"、"俱乐部名称"、"照片链接"三列，列名需完全匹配。

**Q: 可以修改下载的图片格式吗？**
A: 可以在文件命名格式中指定扩展名，如 `.jpg`、`.png` 等。

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！

---

🌟 如果这个项目对您有帮助，请给它一个 Star！
